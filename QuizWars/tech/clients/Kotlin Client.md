#quizwars #client #kotlin 

Котлин клиент представляет из себя полноценный клиент для игры, который поддерживает как офлайн режим так и онлайн. Он содержит в себе все основные функции для взаимодействия пользователя и сервера. 

## Офлайн 

Офлайн режим работы приложения является неотъемлемой частью Core логики. Она позволяет играть пользователям с уже скаченным контентом прямо на устройстве что позволяет пользоваться приложением даже не имея соединения с интернетом. По сути игрок сможет запустим приложение и имея уже предустановленный контент играть в доступные режимы для офлайн игр.

## Онлайн

Онлайн режим является основным режимом работы приложения. Оно позволяет игроку взаимодействовать с другими пользователями и играть с ними в прямом эфире. Игроку будут доступные онлайн режимы, активности и социальное взаимодействие. 

## Основные функции 

Перечислим основные функции и логику которая должна быть имплементирована в нашем приложении. 
#### Профиль

Для профиля пользователя есть множества различный функций, но что бы было над чем работать его для начала нужно создать. По этому сейчас мы рассмотрим что из себя представляет профиль и как его создать и использовать.

В самом начале, когда пользователь только установил приложение, ему необходимо зайти в уже существующий аккаунт либо создать новый. Зарегистрироваться можно используя уникальное имя пользователя (*username*), уникальную почту (*email*) и так же пароль. При успешном результате он получил все данные своего профиля и JWT токен для дальнейшего использования. Более подробную информацию о полях профиля можно найти тут [[tech/grpc/external/users/v1/API-Reference#Profile|API-Reference]].

Так же пользователь имея JWT токен и передавая его с запросом на сервер для авторизации, может изменять данные своего профайла. А именно:

- [[tech/grpc/external/users/v1/API-Reference#UpdateAvatar|Update avatar method]]
- [[tech/grpc/external/users/v1/API-Reference#UpdateProfile|Update profile method]]

Так же есть метод который позволит пользователю обновить свой пароль (если пользователь находиться в своем аккаунте)

- [[tech/grpc/external/users/v1/API-Reference#ChangePassword|Update password method]]

Метод который позволяет пользователю удалить свой аккаунт.

- [[tech/grpc/external/users/v1/API-Reference#DeleteAccount|Delete account method]]

Важно упомянуть что в окне авторизации, пользователь может войти в систему используя сторонний OAuth2 провайдер, который позволит ему зацементироваться либо войти в систему намного быстрее. Так же иметься метод который позволит пользователю уже существующего аккаунта, привязать свой OAuth2 провайдер к своему QuizWars аккаунту. 

- [[tech/grpc/external/users/v1/API-Reference#OAuthLogin|OAuth login method]]
- [[tech/grpc/external/users/v1/API-Reference#LinkOAuthProvider|Link OAuth provider method]]

#### Социализация

В игре так же предоставлен способ социализации игроков. Он является тем что игроки могут добавлять друг друга в друзья, отслеживать прогресс и даже приглашать в совместные игры. Логика работы такого механизма следующая. Когда первый игрок хочет предложить дружбу другому (найдя того по *username* в поиске либо если они где-то пересеклись), игрок должен зайти в профиль желаемого друга и предложит дружбу если таковой еще нет. Дальше, игрок кому было адресовано это предложение увидит у себя в списке друзей запись которая гласит что ему предложили дружбу и запрос находиться в ожидании. Принимающий может как отвергнуть ее так и принять. Отвергнув ее запись о возможной дружбе будет полностью удалена и первый пользователь может еще раз попробовать предложить дружбу. Если же запрос был принять то ее статус меняться с *PENDING* на *ACCEPTED* что означает что запись о взаимной дружбе была создана и подтверждена. Уже находясь в дружбе любой из участников таких  отношений может разорвать ее, заблокировать второго участника либо разблокировать его. Дружа со статусом *BLOCKED* запретит любому из участников как-либо взаимодействовать с друг другом. 